---
import Layout from "../layouts/Layout.astro";
import Card from "../components/Card.astro";
import ProfileImage from "../components/ProfileImage.astro";
import NavBar from "../components/NavBar.astro";
import Modal from "../components/Modal.astro";
import Contact from "../components/ContactForm.astro";
import Hero from "/public/hero.webp";
import { Image } from "@astrojs/image/components";
---

<Layout title="Moving Homes Together">
  <main>
    <NavBar />
    <Modal />
    <div class="hero-image">
      <Image class="imm" src={Hero} alt="" width={2048} height={2048} />
      <h2 class="hero-text">
        Getting ready to move can be stressful. We can help.
      </h2>
      <h1 class="hero-text">We are with you all the way</h1>
    </div>

    <div class="about-us" id="about">
      <h2>About Us</h2>
      <ul role="list" class="link-card-grid">
        <Card
          src="/organization.webp"
          title="Organization and Planning"
          body="Making the most of your space - edit and organize."
        />
        <Card
          src="/care.webp"
          title="Moving with Care and Ease"
          body="Thinking and planning ahead for your move is the most important part of the process."
        />
        <Card
          src="/declutter.webp"
          title="Decluttering and Downsizing"
          body="Our goal is to keep your process stress free."
        />
      </ul>
    </div>

    <div class="testimonials" id="testm">
      <h2>See what our customers are saying</h2>
      <ul role="list" class="testimonial-flex">
        <ProfileImage
          src="/organization.webp"
          title="Customer Testimonial"
          body="We had a stress-free and easy move with the help of Rachel and her team. \
			          From assistance with downsizing editing, and decluttering to packing and moving,\
			          Rachel and her team were there every step of the way."
        />
        <ProfileImage
          src="/care.webp"
          title="Customer Testimonial"
          body="My husband and I have worked with Rachel Carter for over a year.\
			          We wanted to sell our 'too large' home and downsize to a smaller property.\
			          We relied on Rachel to stage, market, and sell out house while also looking\
			          for a new and appropriate place to live. Navigating through the dual process, \
                Rachel’s constant attention to detail was invaluable. Every phase of downsizing,\
                selling, buying and moving with both properties was handled calmly, professionally,\
                and with great care. Rachel helped lead us to an ideal outcome."
        />
        <ProfileImage
          src="/declutter.webp"
          title="Customer Testimonial"
          body="We had a wonderful experience working with Rachel in getting ready to move\
                and put our house on the market. Her recommendations on home staging and space\
                organizing greatly improved how our house presented and made our move into our\
                new home that much easier. Rachel's professional, thorough knowledge and\
                attitude contributed to a very successful experience. We will definitely recommend her!"
        />
      </ul>
      <div class="bottom"></div>
    </div>
    <Contact />
    <div class="footer">
      <p>COPYRIGHT © 2023 MOVING TOGETHER - ALL RIGHTS RESERVED</p>
    </div>
  </main>
</Layout>

<style>
  html {
    scroll-behavior: smooth;
  }
  body {
    margin: 0;
  }
  main {
    display: flex;
    flex-direction: column;
  }
  .hero-image {
    background-size: cover;
    background-position: center;
    height: 80vh;
    margin: 0 !important;
  }
  .imm {
    z-index: 0;
    height: 80vh;
    width: 100%;
    position: absolute;
    object-fit: cover;
    object-position: 50% 50%;
    filter: brightness(70%);
  }
  .hero-text {
    text-align: center;
    position: relative;
    top: 50%;
    transform: translateY(-50%);
    color: white;
    z-index: 1;
  }
  h2 {
    font-size: 2.5rem;
  }
  h1 {
    font-size: 5rem;
  }
  @media only screen and (max-width: 700px) {
    h2 {
      font-size: 1.5rem;
    }
    h1 {
      font-size: 2rem;
    }
  }
  .about-us {
    margin-top: 8vh;
    margin-bottom: 8vh;
    margin-left: 10vw;
    margin-right: 10vw;
    text-align: center;
    color: var(--accent);
  }
  .testimonials {
    margin-top: 8vh;
    margin-bottom: 8vh;
    margin-left: 5vh;
    margin-right: 5vh;
    text-align: center;
    color: white;
    background-image: linear-gradient(rgba(0, 0, 0, 0.35), rgba(0, 0, 0, 0.35)),
      url("/hero-image.webp");
    background-size: cover;
    background-position: center;
  }
  .testimonials > h2 {
    padding-top: 3rem;
  }
  .bottom {
    height: 4rem;
  }
  .footer {
    height: 8rem;
    background-color: #eeeeee;
  }
  .footer > p {
    text-align: center;
    padding-top: 4rem;
    color: rgb(89, 89, 89);
    font-size: 0.8rem;
  }
  .link-card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(24ch, 1fr));
    gap: 1rem;
    padding: 0;
  }
  .testimonial-flex {
    display: grid;
    justify-items: center;
    grid-template-columns: repeat(auto-fit, minmax(24ch, 1fr));
    gap: 1rem;
    padding: 0;
    margin-left: 5vw;
    margin-right: 5vw;
  }
</style>
<script>
  const hero = document.getElementsByClassName("imm")[0];
  window.addEventListener("scroll", () => {
    let { scrollY } = window;
    const yScroll = ((scrollY * 2) / window.innerHeight) * 0.6;
    const scrollPercentage = Math.max(Math.min(yScroll, 1), 0) * -50 + 50;
    console.log(scrollPercentage);
    hero.animate(
      {
        objectPosition: `center ${scrollPercentage}%`,
      },
      { duration: 400, fill: "forwards" }
    );
  });

    // Move the function definition to the global scope
    function myFunction() {
    document.getElementById("myDropdown")!.classList.toggle("show");
  }
  
  // Close the dropdown if the user clicks outside of it
  window.onclick = (event: MouseEvent): void => {
    if (!(event.target as Element).matches('.dropbtn')) {
      const dropdowns = document.getElementsByClassName("dropdown-content");
      for (let i = 0; i < dropdowns.length; i++) {
        const openDropdown = dropdowns[i] as HTMLElement;
        if (openDropdown.classList.contains('show')) {
          openDropdown.classList.remove('show');
        }
      }
    }
  };

  document.querySelector('.hamburger')?.addEventListener('click', () => {
  document.querySelector('.nav-links')?.classList.toggle('expanded');
});

</script>
